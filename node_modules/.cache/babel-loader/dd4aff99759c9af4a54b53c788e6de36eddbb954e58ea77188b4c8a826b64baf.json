{"ast":null,"code":"// src/TechnicalAnalysis.ts\n\nexport class TechnicalAnalysis {\n  // RSI (Relative Strength Index)\n  static calculateRSI(prices, period = 14) {\n    if (prices.length < period + 1) {\n      return new Array(prices.length).fill(50);\n    }\n    const gains = [];\n    const losses = [];\n\n    // Calculate price changes\n    for (let i = 1; i < prices.length; i++) {\n      const change = prices[i].close - prices[i - 1].close;\n      gains.push(Math.max(change, 0));\n      losses.push(Math.max(-change, 0));\n    }\n    const rsi = [];\n\n    // Calculate initial average gain and loss\n    let avgGain = gains.slice(0, period).reduce((sum, gain) => sum + gain, 0) / period;\n    let avgLoss = losses.slice(0, period).reduce((sum, loss) => sum + loss, 0) / period;\n\n    // Calculate RSI for the first period\n    const rs = avgGain / avgLoss;\n    rsi.push(100 - 100 / (1 + rs));\n\n    // Calculate RSI for remaining periods using smoothing\n    for (let i = period; i < gains.length; i++) {\n      avgGain = (avgGain * (period - 1) + gains[i]) / period;\n      avgLoss = (avgLoss * (period - 1) + losses[i]) / period;\n      const rs = avgGain / avgLoss;\n      rsi.push(100 - 100 / (1 + rs));\n    }\n\n    // Pad the beginning with the first RSI value\n    return new Array(period).fill(rsi[0]).concat(rsi);\n  }\n\n  // MACD (Moving Average Convergence Divergence)\n  static calculateMACD(prices, fastPeriod = 12, slowPeriod = 26, signalPeriod = 9) {\n    const closes = prices.map(p => p.close);\n    const ema12 = this.calculateEMA(closes, fastPeriod);\n    const ema26 = this.calculateEMA(closes, slowPeriod);\n    const macd = ema12.map((fast, i) => fast - ema26[i]);\n    const signal = this.calculateEMA(macd, signalPeriod);\n    const histogram = macd.map((macdVal, i) => macdVal - signal[i]);\n    return {\n      macd,\n      signal,\n      histogram\n    };\n  }\n\n  // Bollinger Bands\n  static calculateBollingerBands(prices, period = 20, stdDev = 2) {\n    const closes = prices.map(p => p.close);\n    const sma = this.calculateSMA(closes, period);\n    const upper = [];\n    const lower = [];\n    for (let i = 0; i < closes.length; i++) {\n      if (i < period - 1) {\n        upper.push(closes[i]);\n        lower.push(closes[i]);\n        continue;\n      }\n      const slice = closes.slice(i - period + 1, i + 1);\n      const mean = slice.reduce((sum, price) => sum + price, 0) / period;\n      const variance = slice.reduce((sum, price) => sum + Math.pow(price - mean, 2), 0) / period;\n      const standardDeviation = Math.sqrt(variance);\n      upper.push(mean + stdDev * standardDeviation);\n      lower.push(mean - stdDev * standardDeviation);\n    }\n    return {\n      upper,\n      middle: sma,\n      lower\n    };\n  }\n\n  // Moving Averages\n  static calculateSMA(prices, period) {\n    const sma = [];\n    for (let i = 0; i < prices.length; i++) {\n      if (i < period - 1) {\n        sma.push(prices[i]);\n        continue;\n      }\n      const sum = prices.slice(i - period + 1, i + 1).reduce((acc, price) => acc + price, 0);\n      sma.push(sum / period);\n    }\n    return sma;\n  }\n  static calculateEMA(prices, period) {\n    const ema = [];\n    const multiplier = 2 / (period + 1);\n\n    // Initialize with SMA\n    if (prices.length >= period) {\n      const initialSMA = prices.slice(0, period).reduce((sum, price) => sum + price, 0) / period;\n      ema.push(initialSMA);\n      for (let i = 1; i < prices.length; i++) {\n        const newEMA = prices[i] * multiplier + ema[i - 1] * (1 - multiplier);\n        ema.push(newEMA);\n      }\n    } else {\n      // If not enough data, use the price itself\n      return prices.map(p => p);\n    }\n    return ema;\n  }\n\n  // Volume Analysis\n  static calculateVolumeMetrics(prices, period = 20) {\n    const volumes = prices.map(p => p.volume);\n    const volumeSMA = this.calculateSMA(volumes, period);\n    const volumeRatio = volumes.map((volume, i) => {\n      if (i < period - 1) return 1;\n      return volume / volumeSMA[i];\n    });\n    return {\n      volumeSMA,\n      volumeRatio\n    };\n  }\n\n  // Support and Resistance\n  static calculateSupportResistance(prices, window = 20) {\n    const highs = prices.map(p => p.high);\n    const lows = prices.map(p => p.low);\n    const support = [];\n    const resistance = [];\n    for (let i = 0; i < prices.length; i++) {\n      if (i < window) {\n        support.push(lows[i]);\n        resistance.push(highs[i]);\n        continue;\n      }\n      const lowWindow = lows.slice(i - window, i + 1);\n      const highWindow = highs.slice(i - window, i + 1);\n      const minLow = Math.min(...lowWindow);\n      const maxHigh = Math.max(...highWindow);\n      support.push(minLow);\n      resistance.push(maxHigh);\n    }\n    return {\n      support,\n      resistance\n    };\n  }\n\n  // Calculate all technical indicators\n  static calculateAllIndicators(prices) {\n    return {\n      rsi: this.calculateRSI(prices),\n      macd: this.calculateMACD(prices),\n      bollingerBands: this.calculateBollingerBands(prices),\n      movingAverages: {\n        sma20: this.calculateSMA(prices.map(p => p.close), 20),\n        sma50: this.calculateSMA(prices.map(p => p.close), 50),\n        ema12: this.calculateEMA(prices.map(p => p.close), 12),\n        ema26: this.calculateEMA(prices.map(p => p.close), 26)\n      },\n      volume: this.calculateVolumeMetrics(prices),\n      supportResistance: this.calculateSupportResistance(prices)\n    };\n  }\n\n  // Buy/Sell Recommendation Logic\n  static generateRecommendations(prices, indicators, fundamentals, currentPrice) {\n    const signals = {\n      bullish: [],\n      bearish: [],\n      neutral: []\n    };\n    let technicalScore = 0;\n    let fundamentalScore = 0;\n    let riskScore = 0;\n\n    // Technical Analysis\n    const currentRSI = indicators.rsi[indicators.rsi.length - 1];\n    const currentMACD = indicators.macd.macd[indicators.macd.macd.length - 1];\n    const currentSignal = indicators.macd.signal[indicators.macd.signal.length - 1];\n    const currentHistogram = indicators.macd.histogram[indicators.macd.histogram.length - 1];\n    const currentBBUpper = indicators.bollingerBands.upper[indicators.bollingerBands.upper.length - 1];\n    const currentBBLower = indicators.bollingerBands.lower[indicators.bollingerBands.lower.length - 1];\n    const currentSMA20 = indicators.movingAverages.sma20[indicators.movingAverages.sma20.length - 1];\n    const currentSMA50 = indicators.movingAverages.sma50[indicators.movingAverages.sma50.length - 1];\n\n    // RSI Analysis\n    if (currentRSI < 30) {\n      signals.bullish.push('RSI indicates oversold conditions (RSI: ' + currentRSI.toFixed(1) + ')');\n      technicalScore += 2;\n    } else if (currentRSI > 70) {\n      signals.bearish.push('RSI indicates overbought conditions (RSI: ' + currentRSI.toFixed(1) + ')');\n      technicalScore -= 2;\n    } else {\n      signals.neutral.push('RSI is in neutral territory (RSI: ' + currentRSI.toFixed(1) + ')');\n    }\n\n    // MACD Analysis\n    if (currentMACD > currentSignal && currentHistogram > 0) {\n      signals.bullish.push('MACD is above signal line and histogram is positive');\n      technicalScore += 1;\n    } else if (currentMACD < currentSignal && currentHistogram < 0) {\n      signals.bearish.push('MACD is below signal line and histogram is negative');\n      technicalScore -= 1;\n    }\n\n    // Bollinger Bands Analysis\n    if (currentPrice < currentBBLower) {\n      signals.bullish.push('Price is below lower Bollinger Band (potential bounce)');\n      technicalScore += 1;\n    } else if (currentPrice > currentBBUpper) {\n      signals.bearish.push('Price is above upper Bollinger Band (potential reversal)');\n      technicalScore -= 1;\n    }\n\n    // Moving Average Analysis\n    if (currentPrice > currentSMA20 && currentSMA20 > currentSMA50) {\n      signals.bullish.push('Price above 20-day SMA and 20-day SMA above 50-day SMA');\n      technicalScore += 1;\n    } else if (currentPrice < currentSMA20 && currentSMA20 < currentSMA50) {\n      signals.bearish.push('Price below 20-day SMA and 20-day SMA below 50-day SMA');\n      technicalScore -= 1;\n    }\n\n    // Fundamental Analysis\n    if (fundamentals.pe && fundamentals.pe < 15) {\n      signals.bullish.push('P/E ratio is low (P/E: ' + fundamentals.pe.toFixed(1) + ')');\n      fundamentalScore += 1;\n    } else if (fundamentals.pe && fundamentals.pe > 25) {\n      signals.bearish.push('P/E ratio is high (P/E: ' + fundamentals.pe.toFixed(1) + ')');\n      fundamentalScore -= 1;\n    }\n    if (fundamentals.pb && fundamentals.pb < 1) {\n      signals.bullish.push('P/B ratio is below 1 (P/B: ' + fundamentals.pb.toFixed(2) + ')');\n      fundamentalScore += 1;\n    } else if (fundamentals.pb && fundamentals.pb > 3) {\n      signals.bearish.push('P/B ratio is high (P/B: ' + fundamentals.pb.toFixed(2) + ')');\n      fundamentalScore -= 1;\n    }\n    if (fundamentals.peg && fundamentals.peg < 1) {\n      signals.bullish.push('PEG ratio indicates undervaluation (PEG: ' + fundamentals.peg.toFixed(2) + ')');\n      fundamentalScore += 1;\n    } else if (fundamentals.peg && fundamentals.peg > 1.5) {\n      signals.bearish.push('PEG ratio indicates overvaluation (PEG: ' + fundamentals.peg.toFixed(2) + ')');\n      fundamentalScore -= 1;\n    }\n\n    // Risk Analysis\n    const volatility = this.calculateVolatility(prices);\n    if (volatility < 0.15) {\n      signals.neutral.push('Low volatility indicates stable price movement');\n      riskScore += 1;\n    } else if (volatility > 0.3) {\n      signals.bearish.push('High volatility indicates increased risk');\n      riskScore -= 1;\n    }\n\n    // Generate recommendations\n    const technical = this.createRecommendation(technicalScore, 'TECHNICAL', signals);\n    const fundamental = this.createRecommendation(fundamentalScore, 'FUNDAMENTAL', signals);\n    const risk = this.createRecommendation(riskScore, 'RISK', signals);\n\n    // Overall recommendation\n    const overallScore = (technicalScore + fundamentalScore + riskScore) / 3;\n    const overall = this.createRecommendation(overallScore, 'OVERALL', signals, currentPrice);\n    const summary = this.generateSummary(signals, overall);\n    return {\n      overall,\n      technical,\n      fundamental,\n      risk,\n      signals,\n      summary\n    };\n  }\n  static calculateVolatility(prices) {\n    const returns = [];\n    for (let i = 1; i < prices.length; i++) {\n      returns.push(Math.log(prices[i].close / prices[i - 1].close));\n    }\n    const mean = returns.reduce((sum, ret) => sum + ret, 0) / returns.length;\n    const variance = returns.reduce((sum, ret) => sum + Math.pow(ret - mean, 2), 0) / returns.length;\n    return Math.sqrt(variance * 252); // Annualized volatility\n  }\n  static createRecommendation(score, type, signals, currentPrice) {\n    let action;\n    let confidence;\n    let riskLevel;\n    let timeHorizon;\n    if (score >= 1.5) {\n      action = 'BUY';\n      confidence = Math.min(90, 70 + score * 10);\n    } else if (score <= -1.5) {\n      action = 'SELL';\n      confidence = Math.min(90, 70 + Math.abs(score) * 10);\n    } else {\n      action = 'HOLD';\n      confidence = 50 + Math.abs(score) * 20;\n    }\n\n    // Determine risk level based on volatility and signals\n    const bearishCount = signals.bearish.length;\n    const bullishCount = signals.bullish.length;\n    if (bearishCount > bullishCount + 2) {\n      riskLevel = 'HIGH';\n    } else if (bullishCount > bearishCount + 2) {\n      riskLevel = 'LOW';\n    } else {\n      riskLevel = 'MEDIUM';\n    }\n\n    // Determine time horizon\n    if (type === 'TECHNICAL') {\n      timeHorizon = 'SHORT';\n    } else if (type === 'FUNDAMENTAL') {\n      timeHorizon = 'LONG';\n    } else {\n      timeHorizon = 'MEDIUM';\n    }\n\n    // Calculate price targets\n    const priceTargets = currentPrice ? {\n      conservative: currentPrice * (1 + score * 0.05),\n      moderate: currentPrice * (1 + score * 0.10),\n      aggressive: currentPrice * (1 + score * 0.20)\n    } : {\n      conservative: 0,\n      moderate: 0,\n      aggressive: 0\n    };\n    return {\n      action,\n      confidence: Math.round(confidence),\n      reasoning: type === 'OVERALL' ? [...signals.bullish, ...signals.bearish, ...signals.neutral].slice(0, 5) : [],\n      riskLevel,\n      timeHorizon,\n      priceTargets,\n      stopLoss: currentPrice ? currentPrice * 0.95 : 0,\n      takeProfit: currentPrice ? currentPrice * 1.15 : 0\n    };\n  }\n  static generateSummary(signals, overall) {\n    const bullishCount = signals.bullish.length;\n    const bearishCount = signals.bearish.length;\n    const neutralCount = signals.neutral.length;\n    if (overall.action === 'BUY') {\n      return `Strong buy recommendation with ${overall.confidence}% confidence. ${bullishCount} bullish signals vs ${bearishCount} bearish signals. Consider this a ${overall.riskLevel.toLowerCase()} risk opportunity for ${overall.timeHorizon.toLowerCase()} term investment.`;\n    } else if (overall.action === 'SELL') {\n      return `Sell recommendation with ${overall.confidence}% confidence. ${bearishCount} bearish signals vs ${bullishCount} bullish signals. Exercise caution as this represents a ${overall.riskLevel.toLowerCase()} risk situation.`;\n    } else {\n      return `Hold recommendation with ${overall.confidence}% confidence. Mixed signals with ${bullishCount} bullish, ${bearishCount} bearish, and ${neutralCount} neutral indicators. Monitor for clearer directional signals.`;\n    }\n  }\n}","map":{"version":3,"names":["TechnicalAnalysis","calculateRSI","prices","period","length","Array","fill","gains","losses","i","change","close","push","Math","max","rsi","avgGain","slice","reduce","sum","gain","avgLoss","loss","rs","concat","calculateMACD","fastPeriod","slowPeriod","signalPeriod","closes","map","p","ema12","calculateEMA","ema26","macd","fast","signal","histogram","macdVal","calculateBollingerBands","stdDev","sma","calculateSMA","upper","lower","mean","price","variance","pow","standardDeviation","sqrt","middle","acc","ema","multiplier","initialSMA","newEMA","calculateVolumeMetrics","volumes","volume","volumeSMA","volumeRatio","calculateSupportResistance","window","highs","high","lows","low","support","resistance","lowWindow","highWindow","minLow","min","maxHigh","calculateAllIndicators","bollingerBands","movingAverages","sma20","sma50","supportResistance","generateRecommendations","indicators","fundamentals","currentPrice","signals","bullish","bearish","neutral","technicalScore","fundamentalScore","riskScore","currentRSI","currentMACD","currentSignal","currentHistogram","currentBBUpper","currentBBLower","currentSMA20","currentSMA50","toFixed","pe","pb","peg","volatility","calculateVolatility","technical","createRecommendation","fundamental","risk","overallScore","overall","summary","generateSummary","returns","log","ret","score","type","action","confidence","riskLevel","timeHorizon","abs","bearishCount","bullishCount","priceTargets","conservative","moderate","aggressive","round","reasoning","stopLoss","takeProfit","neutralCount","toLowerCase"],"sources":["/Users/slongo/Documents/simone_misc/stock_widget/src/TechnicalAnalysis.ts"],"sourcesContent":["// src/TechnicalAnalysis.ts\nimport { PricePoint, TechnicalIndicators, Recommendation, RecommendationAnalysis } from './types';\n\nexport class TechnicalAnalysis {\n  // RSI (Relative Strength Index)\n  static calculateRSI(prices: PricePoint[], period: number = 14): number[] {\n    if (prices.length < period + 1) {\n      return new Array(prices.length).fill(50);\n    }\n\n    const gains: number[] = [];\n    const losses: number[] = [];\n\n    // Calculate price changes\n    for (let i = 1; i < prices.length; i++) {\n      const change = prices[i].close - prices[i - 1].close;\n      gains.push(Math.max(change, 0));\n      losses.push(Math.max(-change, 0));\n    }\n\n    const rsi: number[] = [];\n    \n    // Calculate initial average gain and loss\n    let avgGain = gains.slice(0, period).reduce((sum, gain) => sum + gain, 0) / period;\n    let avgLoss = losses.slice(0, period).reduce((sum, loss) => sum + loss, 0) / period;\n\n    // Calculate RSI for the first period\n    const rs = avgGain / avgLoss;\n    rsi.push(100 - (100 / (1 + rs)));\n\n    // Calculate RSI for remaining periods using smoothing\n    for (let i = period; i < gains.length; i++) {\n      avgGain = (avgGain * (period - 1) + gains[i]) / period;\n      avgLoss = (avgLoss * (period - 1) + losses[i]) / period;\n      \n      const rs = avgGain / avgLoss;\n      rsi.push(100 - (100 / (1 + rs)));\n    }\n\n    // Pad the beginning with the first RSI value\n    return new Array(period).fill(rsi[0]).concat(rsi);\n  }\n\n  // MACD (Moving Average Convergence Divergence)\n  static calculateMACD(prices: PricePoint[], fastPeriod: number = 12, slowPeriod: number = 26, signalPeriod: number = 9) {\n    const closes = prices.map(p => p.close);\n    \n    const ema12 = this.calculateEMA(closes, fastPeriod);\n    const ema26 = this.calculateEMA(closes, slowPeriod);\n    \n    const macd = ema12.map((fast, i) => fast - ema26[i]);\n    const signal = this.calculateEMA(macd, signalPeriod);\n    const histogram = macd.map((macdVal, i) => macdVal - signal[i]);\n\n    return { macd, signal, histogram };\n  }\n\n  // Bollinger Bands\n  static calculateBollingerBands(prices: PricePoint[], period: number = 20, stdDev: number = 2) {\n    const closes = prices.map(p => p.close);\n    const sma = this.calculateSMA(closes, period);\n    \n    const upper: number[] = [];\n    const lower: number[] = [];\n\n    for (let i = 0; i < closes.length; i++) {\n      if (i < period - 1) {\n        upper.push(closes[i]);\n        lower.push(closes[i]);\n        continue;\n      }\n\n      const slice = closes.slice(i - period + 1, i + 1);\n      const mean = slice.reduce((sum, price) => sum + price, 0) / period;\n      const variance = slice.reduce((sum, price) => sum + Math.pow(price - mean, 2), 0) / period;\n      const standardDeviation = Math.sqrt(variance);\n\n      upper.push(mean + (stdDev * standardDeviation));\n      lower.push(mean - (stdDev * standardDeviation));\n    }\n\n    return { upper, middle: sma, lower };\n  }\n\n  // Moving Averages\n  static calculateSMA(prices: number[], period: number): number[] {\n    const sma: number[] = [];\n    \n    for (let i = 0; i < prices.length; i++) {\n      if (i < period - 1) {\n        sma.push(prices[i]);\n        continue;\n      }\n      \n      const sum = prices.slice(i - period + 1, i + 1).reduce((acc, price) => acc + price, 0);\n      sma.push(sum / period);\n    }\n    \n    return sma;\n  }\n\n  static calculateEMA(prices: number[], period: number): number[] {\n    const ema: number[] = [];\n    const multiplier = 2 / (period + 1);\n    \n    // Initialize with SMA\n    if (prices.length >= period) {\n      const initialSMA = prices.slice(0, period).reduce((sum, price) => sum + price, 0) / period;\n      ema.push(initialSMA);\n      \n      for (let i = 1; i < prices.length; i++) {\n        const newEMA = (prices[i] * multiplier) + (ema[i - 1] * (1 - multiplier));\n        ema.push(newEMA);\n      }\n    } else {\n      // If not enough data, use the price itself\n      return prices.map(p => p);\n    }\n    \n    return ema;\n  }\n\n  // Volume Analysis\n  static calculateVolumeMetrics(prices: PricePoint[], period: number = 20) {\n    const volumes = prices.map(p => p.volume);\n    const volumeSMA = this.calculateSMA(volumes, period);\n    \n    const volumeRatio = volumes.map((volume, i) => {\n      if (i < period - 1) return 1;\n      return volume / volumeSMA[i];\n    });\n\n    return { volumeSMA, volumeRatio };\n  }\n\n  // Support and Resistance\n  static calculateSupportResistance(prices: PricePoint[], window: number = 20) {\n    const highs = prices.map(p => p.high);\n    const lows = prices.map(p => p.low);\n    \n    const support: number[] = [];\n    const resistance: number[] = [];\n\n    for (let i = 0; i < prices.length; i++) {\n      if (i < window) {\n        support.push(lows[i]);\n        resistance.push(highs[i]);\n        continue;\n      }\n\n      const lowWindow = lows.slice(i - window, i + 1);\n      const highWindow = highs.slice(i - window, i + 1);\n      \n      const minLow = Math.min(...lowWindow);\n      const maxHigh = Math.max(...highWindow);\n      \n      support.push(minLow);\n      resistance.push(maxHigh);\n    }\n\n    return { support, resistance };\n  }\n\n  // Calculate all technical indicators\n  static calculateAllIndicators(prices: PricePoint[]): TechnicalIndicators {\n    return {\n      rsi: this.calculateRSI(prices),\n      macd: this.calculateMACD(prices),\n      bollingerBands: this.calculateBollingerBands(prices),\n      movingAverages: {\n        sma20: this.calculateSMA(prices.map(p => p.close), 20),\n        sma50: this.calculateSMA(prices.map(p => p.close), 50),\n        ema12: this.calculateEMA(prices.map(p => p.close), 12),\n        ema26: this.calculateEMA(prices.map(p => p.close), 26)\n      },\n      volume: this.calculateVolumeMetrics(prices),\n      supportResistance: this.calculateSupportResistance(prices)\n    };\n  }\n\n  // Buy/Sell Recommendation Logic\n  static generateRecommendations(\n    prices: PricePoint[], \n    indicators: TechnicalIndicators, \n    fundamentals: any,\n    currentPrice: number\n  ): RecommendationAnalysis {\n    const signals = {\n      bullish: [] as string[],\n      bearish: [] as string[],\n      neutral: [] as string[]\n    };\n\n    let technicalScore = 0;\n    let fundamentalScore = 0;\n    let riskScore = 0;\n\n    // Technical Analysis\n    const currentRSI = indicators.rsi[indicators.rsi.length - 1];\n    const currentMACD = indicators.macd.macd[indicators.macd.macd.length - 1];\n    const currentSignal = indicators.macd.signal[indicators.macd.signal.length - 1];\n    const currentHistogram = indicators.macd.histogram[indicators.macd.histogram.length - 1];\n    \n    const currentBBUpper = indicators.bollingerBands.upper[indicators.bollingerBands.upper.length - 1];\n    const currentBBLower = indicators.bollingerBands.lower[indicators.bollingerBands.lower.length - 1];\n\n    const currentSMA20 = indicators.movingAverages.sma20[indicators.movingAverages.sma20.length - 1];\n    const currentSMA50 = indicators.movingAverages.sma50[indicators.movingAverages.sma50.length - 1];\n\n    // RSI Analysis\n    if (currentRSI < 30) {\n      signals.bullish.push('RSI indicates oversold conditions (RSI: ' + currentRSI.toFixed(1) + ')');\n      technicalScore += 2;\n    } else if (currentRSI > 70) {\n      signals.bearish.push('RSI indicates overbought conditions (RSI: ' + currentRSI.toFixed(1) + ')');\n      technicalScore -= 2;\n    } else {\n      signals.neutral.push('RSI is in neutral territory (RSI: ' + currentRSI.toFixed(1) + ')');\n    }\n\n    // MACD Analysis\n    if (currentMACD > currentSignal && currentHistogram > 0) {\n      signals.bullish.push('MACD is above signal line and histogram is positive');\n      technicalScore += 1;\n    } else if (currentMACD < currentSignal && currentHistogram < 0) {\n      signals.bearish.push('MACD is below signal line and histogram is negative');\n      technicalScore -= 1;\n    }\n\n    // Bollinger Bands Analysis\n    if (currentPrice < currentBBLower) {\n      signals.bullish.push('Price is below lower Bollinger Band (potential bounce)');\n      technicalScore += 1;\n    } else if (currentPrice > currentBBUpper) {\n      signals.bearish.push('Price is above upper Bollinger Band (potential reversal)');\n      technicalScore -= 1;\n    }\n\n    // Moving Average Analysis\n    if (currentPrice > currentSMA20 && currentSMA20 > currentSMA50) {\n      signals.bullish.push('Price above 20-day SMA and 20-day SMA above 50-day SMA');\n      technicalScore += 1;\n    } else if (currentPrice < currentSMA20 && currentSMA20 < currentSMA50) {\n      signals.bearish.push('Price below 20-day SMA and 20-day SMA below 50-day SMA');\n      technicalScore -= 1;\n    }\n\n    // Fundamental Analysis\n    if (fundamentals.pe && fundamentals.pe < 15) {\n      signals.bullish.push('P/E ratio is low (P/E: ' + fundamentals.pe.toFixed(1) + ')');\n      fundamentalScore += 1;\n    } else if (fundamentals.pe && fundamentals.pe > 25) {\n      signals.bearish.push('P/E ratio is high (P/E: ' + fundamentals.pe.toFixed(1) + ')');\n      fundamentalScore -= 1;\n    }\n\n    if (fundamentals.pb && fundamentals.pb < 1) {\n      signals.bullish.push('P/B ratio is below 1 (P/B: ' + fundamentals.pb.toFixed(2) + ')');\n      fundamentalScore += 1;\n    } else if (fundamentals.pb && fundamentals.pb > 3) {\n      signals.bearish.push('P/B ratio is high (P/B: ' + fundamentals.pb.toFixed(2) + ')');\n      fundamentalScore -= 1;\n    }\n\n    if (fundamentals.peg && fundamentals.peg < 1) {\n      signals.bullish.push('PEG ratio indicates undervaluation (PEG: ' + fundamentals.peg.toFixed(2) + ')');\n      fundamentalScore += 1;\n    } else if (fundamentals.peg && fundamentals.peg > 1.5) {\n      signals.bearish.push('PEG ratio indicates overvaluation (PEG: ' + fundamentals.peg.toFixed(2) + ')');\n      fundamentalScore -= 1;\n    }\n\n    // Risk Analysis\n    const volatility = this.calculateVolatility(prices);\n    if (volatility < 0.15) {\n      signals.neutral.push('Low volatility indicates stable price movement');\n      riskScore += 1;\n    } else if (volatility > 0.3) {\n      signals.bearish.push('High volatility indicates increased risk');\n      riskScore -= 1;\n    }\n\n    // Generate recommendations\n    const technical = this.createRecommendation(technicalScore, 'TECHNICAL', signals);\n    const fundamental = this.createRecommendation(fundamentalScore, 'FUNDAMENTAL', signals);\n    const risk = this.createRecommendation(riskScore, 'RISK', signals);\n\n    // Overall recommendation\n    const overallScore = (technicalScore + fundamentalScore + riskScore) / 3;\n    const overall = this.createRecommendation(overallScore, 'OVERALL', signals, currentPrice);\n\n    const summary = this.generateSummary(signals, overall);\n\n    return {\n      overall,\n      technical,\n      fundamental,\n      risk,\n      signals,\n      summary\n    };\n  }\n\n  private static calculateVolatility(prices: PricePoint[]): number {\n    const returns = [];\n    for (let i = 1; i < prices.length; i++) {\n      returns.push(Math.log(prices[i].close / prices[i - 1].close));\n    }\n    \n    const mean = returns.reduce((sum, ret) => sum + ret, 0) / returns.length;\n    const variance = returns.reduce((sum, ret) => sum + Math.pow(ret - mean, 2), 0) / returns.length;\n    return Math.sqrt(variance * 252); // Annualized volatility\n  }\n\n  private static createRecommendation(\n    score: number, \n    type: string, \n    signals: any, \n    currentPrice?: number\n  ): Recommendation {\n    let action: 'BUY' | 'SELL' | 'HOLD';\n    let confidence: number;\n    let riskLevel: 'LOW' | 'MEDIUM' | 'HIGH';\n    let timeHorizon: 'SHORT' | 'MEDIUM' | 'LONG';\n\n    if (score >= 1.5) {\n      action = 'BUY';\n      confidence = Math.min(90, 70 + score * 10);\n    } else if (score <= -1.5) {\n      action = 'SELL';\n      confidence = Math.min(90, 70 + Math.abs(score) * 10);\n    } else {\n      action = 'HOLD';\n      confidence = 50 + Math.abs(score) * 20;\n    }\n\n    // Determine risk level based on volatility and signals\n    const bearishCount = signals.bearish.length;\n    const bullishCount = signals.bullish.length;\n    \n    if (bearishCount > bullishCount + 2) {\n      riskLevel = 'HIGH';\n    } else if (bullishCount > bearishCount + 2) {\n      riskLevel = 'LOW';\n    } else {\n      riskLevel = 'MEDIUM';\n    }\n\n    // Determine time horizon\n    if (type === 'TECHNICAL') {\n      timeHorizon = 'SHORT';\n    } else if (type === 'FUNDAMENTAL') {\n      timeHorizon = 'LONG';\n    } else {\n      timeHorizon = 'MEDIUM';\n    }\n\n    // Calculate price targets\n    const priceTargets = currentPrice ? {\n      conservative: currentPrice * (1 + (score * 0.05)),\n      moderate: currentPrice * (1 + (score * 0.10)),\n      aggressive: currentPrice * (1 + (score * 0.20))\n    } : {\n      conservative: 0,\n      moderate: 0,\n      aggressive: 0\n    };\n\n    return {\n      action,\n      confidence: Math.round(confidence),\n      reasoning: type === 'OVERALL' ? \n        [...signals.bullish, ...signals.bearish, ...signals.neutral].slice(0, 5) :\n        [],\n      riskLevel,\n      timeHorizon,\n      priceTargets,\n      stopLoss: currentPrice ? currentPrice * 0.95 : 0,\n      takeProfit: currentPrice ? currentPrice * 1.15 : 0\n    };\n  }\n\n  private static generateSummary(signals: any, overall: Recommendation): string {\n    const bullishCount = signals.bullish.length;\n    const bearishCount = signals.bearish.length;\n    const neutralCount = signals.neutral.length;\n\n    if (overall.action === 'BUY') {\n      return `Strong buy recommendation with ${overall.confidence}% confidence. ${bullishCount} bullish signals vs ${bearishCount} bearish signals. Consider this a ${overall.riskLevel.toLowerCase()} risk opportunity for ${overall.timeHorizon.toLowerCase()} term investment.`;\n    } else if (overall.action === 'SELL') {\n      return `Sell recommendation with ${overall.confidence}% confidence. ${bearishCount} bearish signals vs ${bullishCount} bullish signals. Exercise caution as this represents a ${overall.riskLevel.toLowerCase()} risk situation.`;\n    } else {\n      return `Hold recommendation with ${overall.confidence}% confidence. Mixed signals with ${bullishCount} bullish, ${bearishCount} bearish, and ${neutralCount} neutral indicators. Monitor for clearer directional signals.`;\n    }\n  }\n} "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}